<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
  <meta name="theme-color" content="#0b1220"/>
  <title>Fighting Llamas â€” Snake XL (with Sounds & Power-Ups)</title>
  <style>
    :root{
      --bg:#0b0f1a;
      --bg2:#0e1424;
      --field:#0f6d43;
      --field2:#09412b;
      --chalk:#e8edf2;
      --gold:#ffd166;
      --accent:#8ecae6;
      --danger:#ef476f;
      --poop:#5a3a22;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; background:radial-gradient(1200px 600px at 50% -10%, #18213a 0%, var(--bg) 50%, #080b14 100%);
      color:var(--chalk);
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
      display:flex; flex-direction:column; align-items:center;
    }
    header{width:100%; text-align:center; padding:16px 12px 6px}
    .title{font-weight:900; letter-spacing:.3px; font-size:clamp(18px,4.6vw,34px)}
    .badge{display:inline-block; margin-top:6px; border:1px solid var(--gold); color:var(--gold);
           border-radius:999px; padding:6px 12px; font-weight:800; background:linear-gradient(180deg,rgba(255,209,102,.08),transparent)}
    .wrap{width:100%; max-width:840px; padding:8px 12px 18px}
    #hud{display:flex; align-items:center; justify-content:space-between; gap:10px; flex-wrap:wrap}
    .left,.right{display:flex; gap:8px; align-items:center; flex-wrap:wrap}
    .pill{display:inline-flex; align-items:center; gap:6px; border:1px solid #283247; background:linear-gradient(180deg,#0f1425,#0b1120);
          padding:8px 12px; border-radius:12px; font-weight:700; box-shadow:inset 0 0 12px rgba(255,255,255,.02)}
    .pill b{color:var(--gold)}
    button{appearance:none; border:1px solid #283247; background:linear-gradient(180deg,#121a31,#0d1428); color:var(--chalk);
           border-radius:12px; padding:9px 14px; font-weight:800}
    button:active{transform:scale(.98)}
    .primary{border-color:#345; box-shadow:0 0 0 2px rgba(142,202,230,.08) inset}
    select, input[type=checkbox]{background:#0e152a; color:var(--chalk); border:1px solid #283247; border-radius:8px; padding:6px 8px}
    label{display:inline-flex; align-items:center; gap:6px}

    .stadium{position:relative; width:100%; aspect-ratio:1/1; border:2px solid #26314a; border-radius:18px; overflow:hidden;
             background:linear-gradient(180deg,var(--field) 0%, var(--field2) 100%); box-shadow:0 10px 30px rgba(0,0,0,.4), inset 0 0 0 4px rgba(0,0,0,.25)}
    canvas{display:block; width:100%; height:100%}
    .glass{position:absolute; inset:0; background:radial-gradient(1000px 160px at 50% -80px, rgba(255,255,255,.08), rgba(255,255,255,0)); pointer-events:none}

    .overlay{position:absolute; inset:0; display:none; align-items:center; justify-content:center; background:rgba(10,12,18,.55); backdrop-filter:blur(4px)}
    .overlay.show{display:flex}
    .card{background:linear-gradient(180deg,#0f1324,#0a0f1e); border:1px solid #2a3550; border-radius:16px; padding:20px; max-width:92%;
          box-shadow:0 10px 40px rgba(0,0,0,.6)}
    .card h2{margin:0 0 8px; font-size:22px}
    .grid{display:grid; grid-template-columns:repeat(auto-fill,minmax(140px,1fr)); gap:10px; margin-top:8px}
    .chip{border:1px solid #2a3550; border-radius:12px; padding:10px; text-align:center; cursor:pointer;
          background:linear-gradient(180deg,#0f162b,#0c1427)}
    .chip:hover{outline:2px solid rgba(255,209,102,.25)}
    .chip .tag{display:block; font-size:12px; opacity:.7}
    .flex{display:flex; gap:8px; align-items:center; justify-content:center; margin-top:12px}
    .small{opacity:.85; font-size:13px}

    .toast{position:absolute; top:10px; left:50%; transform:translateX(-50%); background:rgba(0,0,0,.6); border:1px solid #2a3550; border-radius:12px; padding:6px 10px; font-weight:700}
    .cooldown{width:110px; height:10px; background:#1a2336; border:1px solid #2a3550; border-radius:999px; overflow:hidden}
    .cooldown > span{display:block; height:100%; width:0%; background:linear-gradient(90deg,var(--danger),#f59e0b)}
  </style>
</head>
<body>
  <header>
    <div class="title">Fighting Llamas â€” Snake XL</div>
    <div class="badge">2025 Fantasy Football â€¢ Commissioner: Taylor Garfield</div>
  </header>

  <div class="wrap">
    <div id="hud">
      <div class="left">
        <div class="pill">Score: <b id="score">0</b></div>
        <div class="pill">High: <b id="high">0</b></div>
        <label class="pill">Speed
          <select id="speedSel" aria-label="Speed">
            <option value="110">1x</option>
            <option value="90">1.25x</option>
            <option value="75">1.5x</option>
            <option value="60">2x</option>
          </select>
        </label>
        <label class="pill"><input type="checkbox" id="soundToggle" checked/> Sound</label>
      </div>
      <div class="right">
        <button id="playBtn" class="primary" title="Play / Resume">Play</button>
        <button id="pauseBtn" title="Pause">Pause</button>
        <button id="resetBtn" title="Reset">Reset</button>
        <button id="abBtn" title="Antonio Brown Power" style="border-color:#553; background:linear-gradient(180deg,#261b12,#1b130d);">Antonio Brown ðŸ’©</button>
        <div class="cooldown" title="Power cooldown"><span id="cdBar"></span></div>
      </div>
    </div>

    <div class="stadium">
      <canvas id="field" width="860" height="860"></canvas>
      <div class="glass"></div>
      <div id="overlay" class="overlay show">
        <div class="card">
          <h2>Choose Your Player</h2>
          <div class="small">Tap a name for a ridiculous intro sound. Tap <b>Start</b> to begin.</div>
          <div class="grid" id="roster"></div>
          <div class="flex">
            <button id="startBtn" class="primary">Start</button>
            <button id="randomBtn">Random</button>
          </div>
        </div>
      </div>
      <div id="toast" class="toast" style="display:none"></div>
    </div>
  </div>

  <script>
  // === ROSTER ===
  const ROSTER = [
    "Nathan Bickel","Liam Keller","Jake Miltenberger","Zak Daboll","Brian Munn","Akash Malhan",
    "Jimmy Garrison","Scott Remily","Tyrone Sanderlin","Chris Tramble","Guy Mazzell","Keith Page",
    "Taylor James Garfield","Zachary Garrison"
  ];

  // === SOUND ENGINE (WebAudio; silly effects) ===
  class SFX {
    constructor(){ this.enabled=true; this.ctx=null; this.master=null; }
    init(){ if(this.ctx) return;
      const AC = window.AudioContext || window.webkitAudioContext;
      this.ctx = new AC();
      this.master = this.ctx.createGain(); this.master.gain.value = 0.18; this.master.connect(this.ctx.destination);
      // Warmup (iOS)
      const o=this.ctx.createOscillator(), g=this.ctx.createGain(); g.gain.value=0; o.connect(g); g.connect(this.master); o.start(); o.stop(this.ctx.currentTime+0.01);
    }
    async resume(){ if(this.ctx && this.ctx.state==='suspended') await this.ctx.resume(); }
    tone({f=440, dur=.08, type='square', start=0, v=.9, slide=0}){
      if(!this.enabled||!this.ctx) return;
      const t=this.ctx.currentTime+start, o=this.ctx.createOscillator(), g=this.ctx.createGain();
      o.type=type; o.frequency.setValueAtTime(f,t); if(slide) o.frequency.exponentialRampToValueAtTime(Math.max(40,f+slide), t+dur);
      g.gain.setValueAtTime(0,t); g.gain.linearRampToValueAtTime(v*0.9, t+0.01); g.gain.exponentialRampToValueAtTime(0.0001, t+dur);
      o.connect(g); g.connect(this.master); o.start(t); o.stop(t+dur+0.02);
    }
    burst({dur=.12, v=.6, start=0}){ // noise burst
      if(!this.enabled||!this.ctx) return;
      const t=this.ctx.currentTime+start, bu=this.ctx.createBuffer(1, this.ctx.sampleRate*dur, this.ctx.sampleRate);
      const d=bu.getChannelData(0); for(let i=0;i<d.length;i++) d[i]=(Math.random()*2-1)*Math.pow(1-i/d.length,2);
      const src=this.ctx.createBufferSource(); src.buffer=bu;
      const g=this.ctx.createGain(); g.gain.value=v; src.connect(g); g.connect(this.master); src.start(t);
    }
    crowd(){ this.burst({dur:.20,v:.35}); this.tone({f:220,dur:.12,type:'sawtooth'}); this.tone({f:330,dur:.14,type:'sawtooth',start:.06}); }
    whistle(){ this.tone({f:1500,dur:.10,type:'triangle'}); this.tone({f:1800,dur:.12,type:'triangle',start:.08}); this.tone({f:2200,dur:.16,type:'triangle',start:.14}); }
    thud(){ this.burst({dur:.10,v:.5}); this.tone({f:110,dur:.08,type:'sine'}); }
    eat(){ this.tone({f:780,dur:.09}); this.tone({f:1040,dur:.09,start:.02}); this.crowd(); }
    turn(){ this.tone({f:420,dur:.05,type:'triangle'}); }
    start(){ this.whistle(); this.crowd(); }
    over(){ this.tone({f:160,dur:.18,type:'sawtooth'}); this.tone({f:120,dur:.22,type:'sawtooth',start:.14}); }
    // ridiculous per-player stingers (randomized)
    silly(name){
      // Map name hash -> pattern
      const h = Array.from(name).reduce((a,c)=>a+c.charCodeAt(0),0);
      const base = 300 + (h%5)*80;
      this.tone({f:base+40,dur:.1,type:'square'});
      this.tone({f:base*2.2,dur:.12,type:'square',start:.05});
      this.burst({dur:.12,v:.45,start:.08});
      this.tone({f:base*0.6,dur:.18,type:'triangle',start:.12,slide:-120});
    }
    poop(){ // splat + whoosh
      this.burst({dur:.18,v:.7}); this.tone({f:90,dur:.22,type:'sine'});
      this.tone({f:2200,dur:.12,type:'triangle',start:.05,slide:-1200});
    }
  }
  const sfx = new SFX();

  // === CANVAS / GAME ===
  const cvs = document.getElementById('field'), ctx = cvs.getContext('2d');
  const overlay = document.getElementById('overlay');
  const startBtn = document.getElementById('startBtn');
  const randomBtn = document.getElementById('randomBtn');
  const rosterEl = document.getElementById('roster');
  const playBtn = document.getElementById('playBtn');
  const pauseBtn = document.getElementById('pauseBtn');
  const resetBtn = document.getElementById('resetBtn');
  const abBtn = document.getElementById('abBtn');
  const cdBar = document.getElementById('cdBar');
  const toast = document.getElementById('toast');
  const scoreEl = document.getElementById('score'); const highEl = document.getElementById('high');
  const spdSel = document.getElementById('speedSel'); const soundToggle = document.getElementById('soundToggle');
  let DPR = Math.max(1, Math.min(2, window.devicePixelRatio||1));
  let rafId;

  function fitCanvas(){
    const rect = cvs.getBoundingClientRect();
    cvs.width = Math.floor(rect.width * DPR);
    cvs.height = Math.floor(rect.height * DPR);
    ctx.setTransform(DPR,0,0,DPR,0,0);
  }
  new ResizeObserver(fitCanvas).observe(cvs); fitCanvas();

  const COLS=28, ROWS=28;
  const state = {
    snake:[], dir:{x:1,y:0}, next:{x:1,y:0}, food:{x:0,y:0}, score:0, high:Number(localStorage.getItem('ll_high2')||0),
    running:false, timer:null, speed:Number(spdSel.value), particles:[], player:null,
    power:false, powerUntil:0, cdUntil:0, now:performance.now()
  };
  highEl.textContent = state.high;

  function rnd(n){ return Math.floor(Math.random()*n); }
  function placeFood(){ while(true){ const x=rnd(COLS), y=rnd(ROWS); if(!state.snake.some(s=>s.x===x&&s.y===y)){ state.food={x,y}; return; }}}
  function reset(){
    const mx=Math.floor(COLS/2), my=Math.floor(ROWS/2);
    state.snake=[{x:mx,y:my},{x:mx-1,y:my},{x:mx-2,y:my}];
    state.dir={x:1,y:0}; state.next={x:1,y:0}; state.score=0; scoreEl.textContent=0;
    state.power=false; state.particles.length=0; placeFood(); draw(true);
  }

  function start(){ state.running=true; clearInterval(state.timer); state.timer=setInterval(tick, state.speed); sfx.start(); hideOverlay(); }
  function pause(){ state.running=false; clearInterval(state.timer); showOverlay("Paused","Tap Start or Play to resume."); }
  function gameOver(){ state.running=false; clearInterval(state.timer); sfx.over(); showOverlay(`Game Over â€“ ${state.player||'Player'}`,`Score ${state.score}. Tap Start to try again.`); }

  function setDir(x,y){ if((x===-state.dir.x&&y===0)||(y===-state.dir.y&&x===0)) return; state.next={x,y}; sfx.turn(); }

  // POWER: Antonio Brown
  function abPower(){
    const now = performance.now();
    if(now < state.cdUntil) return; // on cooldown
    sfx.poop();
    // 5s power, 15s cooldown
    state.power = true; state.powerUntil = now + 5000; state.cdUntil = now + 15000;
    toastMsg("Antonio Brown Power! ðŸ’© Speed up + self-ghosting 5s");
  }

  // UI helpers
  function showOverlay(title, sub){
    overlay.querySelector('h2').textContent = title;
    overlay.querySelector('.small').innerHTML = sub;
    overlay.classList.add('show');
  }
  function hideOverlay(){ overlay.classList.remove('show'); }

  function toastMsg(msg){ toast.textContent=msg; toast.style.display='block'; setTimeout(()=>toast.style.display='none', 1600); }

  // Build roster chips
  ROSTER.forEach(name=>{
    const d=document.createElement('div'); d.className='chip';
    d.innerHTML = `<div style="font-weight:800">${name.split(' ')[0]}</div><span class="tag">${name}</span>`;
    d.addEventListener('click', async()=>{ sfx.init(); await sfx.resume(); sfx.silly(name); state.player=name; });
    rosterEl.appendChild(d);
  });
  randomBtn.addEventListener('click', async()=>{ sfx.init(); await sfx.resume(); const name=ROSTER[rnd(ROSTER.length)]; sfx.silly(name); state.player=name; });

  startBtn.addEventListener('click', async()=>{ sfx.init(); await sfx.resume(); if(!state.player){ const name=ROSTER[rnd(ROSTER.length)]; sfx.silly(name); state.player=name; } reset(); start(); });
  playBtn.addEventListener('click', async()=>{ sfx.init(); await sfx.resume(); if(!state.running){ start(); }});
  pauseBtn.addEventListener('click', ()=> pause());
  resetBtn.addEventListener('click', ()=>{ reset(); showOverlay("Choose Your Player","Tap a name then Start."); });
  spdSel.addEventListener('change',()=>{ state.speed=Number(spdSel.value); if(state.running){ clearInterval(state.timer); state.timer=setInterval(tick,state.speed);} });
  soundToggle.addEventListener('change',()=>{ sfx.enabled = soundToggle.checked; });
  abBtn.addEventListener('click', abPower);

  // Controls
  window.addEventListener('keydown',e=>{
    const c=e.code;
    if(c==='ArrowUp'||c==='KeyW') setDir(0,-1);
    else if(c==='ArrowDown'||c==='KeyS') setDir(0,1);
    else if(c==='ArrowLeft'||c==='KeyA') setDir(-1,0);
    else if(c==='ArrowRight'||c==='KeyD') setDir(1,0);
    else if(c==='Space') abPower();
  });
  // Touch pads: swipe on canvas
  let ts=null; cvs.addEventListener('touchstart',e=>{ ts={x:e.touches[0].clientX, y:e.touches[0].clientY}; },{passive:true});
  cvs.addEventListener('touchmove',e=>{
    if(!ts) return; const dx=e.touches[0].clientX-ts.x, dy=e.touches[0].clientY-ts.y;
    const ax=Math.abs(dx), ay=Math.abs(dy); if(Math.max(ax,ay)>24){ if(ax>ay) setDir(Math.sign(dx),0); else setDir(0,Math.sign(dy)); ts=null; }
  },{passive:true});

  // Particles
  function addParticles(x,y,color){ for(let i=0;i<10;i++){ state.particles.push({x,y, vx:(Math.random()-.5)*2, vy:(Math.random()-.6)*2, life:1, color}); } }

  // Tick (game step)
  function tick(){
    state.dir=state.next;
    const head={x:state.snake[0].x+state.dir.x, y:state.snake[0].y+state.dir.y};
    // walls
    if(head.x<0||head.y<0||head.x>=COLS||head.y>=ROWS){ sfx.thud(); return gameOver(); }
    // self collision (unless power)
    if(!state.power && state.snake.some(s=>s.x===head.x&&s.y===head.y)){ sfx.thud(); return gameOver(); }
    state.snake.unshift(head);
    if(head.x===state.food.x && head.y===state.food.y){
      state.score++; scoreEl.textContent=state.score; if(state.score>state.high){ state.high=state.score; highEl.textContent=state.high; localStorage.setItem('ll_high2', String(state.high)); }
      sfx.eat(); addParticles(head.x,head.y,'#ffd166'); placeFood();
    } else {
      state.snake.pop();
    }
  }

  // Render loop
  function render(t){
    state.now = performance.now();
    // cooldown bar
    let cd = Math.max(0, state.cdUntil - state.now); let cdPct = 1 - Math.min(1, cd/15000); cdBar.style.width = (cdPct*100).toFixed(1)+'%';
    // power timeout
    if(state.power && state.now >= state.powerUntil){ state.power=false; }

    ctx.clearRect(0,0,cvs.width,cvs.height);
    const w=cvs.clientWidth, h=cvs.clientHeight, size=Math.floor(Math.min(w,h)/COLS);

    // Endzones
    ctx.save();
    ctx.fillStyle='rgba(255,255,255,.06)';
    ctx.fillRect(0,0,size*COLS,size*2);
    ctx.fillRect(0,(ROWS-2)*size,size*COLS,size*2);
    ctx.fillStyle='rgba(255,209,102,.15)';
    ctx.font = `${Math.floor(size*1.2)}px Impact, system-ui, sans-serif`; ctx.textAlign='center'; ctx.textBaseline='middle';
    ctx.fillText('LLAMAS', (COLS*size)/2, size);
    ctx.fillText('LLAMAS', (COLS*size)/2, size*(ROWS-1));
    ctx.restore();

    // Yard lines + hash marks
    ctx.save(); ctx.strokeStyle='rgba(255,255,255,.35)'; ctx.lineWidth=1;
    for(let y=0;y<=ROWS;y+=2){ ctx.beginPath(); ctx.moveTo(0,y*size+.5); ctx.lineTo(COLS*size,y*size+.5); ctx.stroke(); }
    ctx.restore();

    // Food (football)
    drawFootball(state.food.x*size, state.food.y*size, size, size);

    // Snake shadow
    ctx.save(); ctx.globalAlpha=.25; state.snake.forEach(s=>{ ctx.fillStyle='#000'; roundRect(ctx, s.x*size+3, s.y*size+3, size-6, size-6, 6); ctx.fill(); }); ctx.restore();

    // Snake body
    state.snake.forEach((s,i)=>{
      const x=s.x*size, y=s.y*size;
      const grad=ctx.createLinearGradient(x,y,x+size,y+size);
      const c1 = i===0 ? '#92e6a7' : '#61c3a5';
      const c2 = i===0 ? '#2fbf71' : '#2b9f63';
      grad.addColorStop(0, c1); grad.addColorStop(1, c2);
      ctx.fillStyle=grad; roundRect(ctx,x+1,y+1,size-2,size-2,8); ctx.fill();

      if(i===0){ // head details
        // eyes
        ctx.fillStyle='#001'; ctx.beginPath(); ctx.arc(x+size*.35,y+size*.38,size*.07,0,Math.PI*2); ctx.fill();
        ctx.beginPath(); ctx.arc(x+size*.65,y+size*.38,size*.07,0,Math.PI*2); ctx.fill();
        // glow when power
        if(state.power){ ctx.save(); ctx.globalAlpha=.4; ctx.strokeStyle='#f59e0b'; ctx.lineWidth=3; roundRect(ctx,x+1,y+1,size-2,size-2,8); ctx.stroke(); ctx.restore(); }
        // poop splat on head (during power)
        if(state.power){ drawPoop(x+size*.48, y+size*.54, size*.32); }
      }
    });

    // Particles
    for(let i=state.particles.length-1;i>=0;i--){
      const p=state.particles[i]; p.x+=p.vx; p.y+=p.vy; p.life-=.03; if(p.life<=0){ state.particles.splice(i,1); continue; }
      ctx.globalAlpha = Math.max(.1,p.life); ctx.fillStyle=p.color; ctx.beginPath(); ctx.arc(p.x*size+size/2, p.y*size+size/2, 2.2, 0, Math.PI*2); ctx.fill(); ctx.globalAlpha=1;
    }

    rafId = requestAnimationFrame(render);
  }

  function drawFootball(x,y,w,h){
    const cx=x+w/2, cy=y+h/2, rx=w*0.42, ry=h*0.28;
    ctx.save(); ctx.translate(cx,cy);
    const grad=ctx.createLinearGradient(-rx,-ry,rx,ry); grad.addColorStop(0,'#9c4f2b'); grad.addColorStop(1,'#6f311b'); ctx.fillStyle=grad;
    ctx.strokeStyle='#fff'; ctx.lineWidth=2;
    ctx.beginPath(); for(let i=0;i<2;i++){ ctx.ellipse(0,0,rx,ry,0,0,Math.PI); ctx.scale(-1,1); } ctx.fill(); ctx.stroke();
    ctx.strokeStyle='#fff'; ctx.beginPath(); ctx.moveTo(-rx*.6,0); ctx.lineTo(rx*.6,0); ctx.stroke();
    for(let i=-2;i<=2;i++){ ctx.beginPath(); ctx.moveTo(i*rx*.22,-ry*.28); ctx.lineTo(i*rx*.22,ry*.28); ctx.stroke(); }
    ctx.restore();
  }
  function drawPoop(x,y,r){
    ctx.save(); ctx.fillStyle='var(--poop)'; ctx.strokeStyle='#3a2617'; ctx.lineWidth=2;
    ctx.beginPath(); ctx.moveTo(x, y); ctx.quadraticCurveTo(x-r*.5, y-r*.4, x-r*.2, y-r*.7);
    ctx.quadraticCurveTo(x, y-r*1.0, x+r*.2, y-r*.7);
    ctx.quadraticCurveTo(x+r*.5, y-r*.4, x, y); ctx.fill(); ctx.stroke();
    // tiny flies
    for(let i=0;i<3;i++){ ctx.beginPath(); ctx.fillStyle='#000'; ctx.arc(x+(Math.random()-.5)*r, y-(Math.random())*r, 2, 0, Math.PI*2); ctx.fill(); }
    ctx.restore();
  }
  function roundRect(ctx,x,y,w,h,r){ const rr=Math.min(r,w/2,h/2); ctx.beginPath(); ctx.moveTo(x+rr,y); ctx.arcTo(x+w,y,x+w,y+h,rr); ctx.arcTo(x+w,y+h,x,y+h,rr); ctx.arcTo(x,y+h,x,y,rr); ctx.arcTo(x,y,x+w,y,rr); ctx.closePath(); }

  // Start up
  function boot(){ reset(); cancelAnimationFrame(rafId); rafId = requestAnimationFrame(render); }
  boot();

  // overlay initial content already shown; wait for user gesture to init audio
  </script>
</body>
</html>